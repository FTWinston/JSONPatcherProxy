/*! JSONPatcherProxy version: 0.0.10 */
var JSONPatcherProxy=function(e){var t={};function r(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(o,i,function(t){return e[t]}.bind(null,i));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";
/*!
 * https://github.com/Palindrom/JSONPatcherProxy
 * (c) 2017 Starcounter 
 * MIT license
 */const o=function(){function e(e){return-1==e.indexOf("/")&&-1==e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function t(e,t){const r=[];let o=e.parenthoodMap.get(t);for(;o&&o.path;)r.unshift(o.path),o=e.parenthoodMap.get(o.parent);if(r.length){return"/"+r.join("/")}return""}function r(e,t){this.isProxifyingTreeNow=!1,this.isObserving=!1,this.proxifiedObjectsMap=new Map,this.parenthoodMap=new Map,"boolean"!=typeof t&&(t=!0),this.showDetachedWarning=t,this.originalObject=e,this.cachedProxy=null,this.isRecording=!1,this.userCallback,this.resume=function(){this.defaultCallback=e=>{this.isRecording&&this.patches.push(e),this.userCallback&&this.userCallback(e)},this.isObserving=!0}.bind(this),this.pause=function(){this.defaultCallback=()=>{},this.isObserving=!1}.bind(this)}return r.deepClone=function(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}},r.escapePathComponent=e,r.prototype.generateProxyAtPath=function(r,o,i){if(!o)return o;const n={set:(r,o,i,n)=>(function(r,o,i,n){const s=t(r,o)+"/"+e(i);if(r.proxifiedObjectsMap.has(n)){const e=r.proxifiedObjectsMap.get(n);r.parenthoodMap.set(e.originalObject,{parent:o,path:i})}const a=r.proxifiedObjectsMap.get(n);a&&!r.isProxifyingTreeNow&&(a.inherited=!0),n&&"object"==typeof n&&!r.proxifiedObjectsMap.has(n)&&(r.parenthoodMap.set(n,{parent:o,path:i}),n=r._proxifyObjectTreeRecursively(o,n,i));const c={op:"remove",path:s};if(void 0===n){if(!Array.isArray(o)&&!o.hasOwnProperty(i))return Reflect.set(o,i,n);{Array.isArray(o)&&(c.op="replace",c.value=null);const e=r.proxifiedObjectsMap.get(o[i]);e&&(r.parenthoodMap.delete(o[i]),r.disableTrapsForProxy(e),r.proxifiedObjectsMap.delete(e))}}else{if(Array.isArray(o)&&!Number.isInteger(+i.toString()))return"length"!=i&&console.warn("JSONPatcherProxy noticed a non-integer prop was set for an array. This will not emit a patch"),Reflect.set(o,i,n);c.op="add",o.hasOwnProperty(i)&&(void 0!==o[i]||Array.isArray(o))&&(c.op="replace"),c.value=n}const p=Reflect.set(o,i,n);return r.defaultCallback(c),p})(this,r,o,i),deleteProperty:(r,o)=>(function(r,o,i){if(void 0!==o[i]){const n=t(r,o)+"/"+e(i),s=r.proxifiedObjectsMap.get(o[i]);s&&(s.inherited?s.inherited=!1:(r.parenthoodMap.delete(s.originalObject),r.disableTrapsForProxy(s),r.proxifiedObjectsMap.delete(o[i])));const a=Reflect.deleteProperty(o,i);return r.defaultCallback({op:"remove",path:n}),a}})(this,r,o)},s=Proxy.revocable(o,n);return s.trapsInstance=n,s.originalObject=o,this.parenthoodMap.set(o,{parent:r,path:i}),this.proxifiedObjectsMap.set(s.proxy,s),s.proxy},r.prototype._proxifyObjectTreeRecursively=function(t,r,o){for(let t in r)r.hasOwnProperty(t)&&r[t]instanceof Object&&(r[t]=this._proxifyObjectTreeRecursively(r,r[t],e(t)));return this.generateProxyAtPath(t,r,o)},r.prototype.proxifyObjectTree=function(e){this.pause(),this.isProxifyingTreeNow=!0;const t=this._proxifyObjectTreeRecursively(void 0,e,"");return this.isProxifyingTreeNow=!1,this.resume(),t},r.prototype.disableTrapsForProxy=function(e){if(this.showDetachedWarning){const t="You're accessing an object that is detached from the observedObject tree, see https://github.com/Palindrom/JSONPatcherProxy#detached-objects";e.trapsInstance.set=(e,r,o)=>(console.warn(t),Reflect.set(e,r,o)),e.trapsInstance.set=(e,r,o)=>(console.warn(t),Reflect.set(e,r,o)),e.trapsInstance.deleteProperty=(e,t)=>Reflect.deleteProperty(e,t)}else delete e.trapsInstance.set,delete e.trapsInstance.get,delete e.trapsInstance.deleteProperty},r.prototype.observe=function(e,t){if(!e&&!t)throw new Error("You need to either record changes or pass a callback");return this.isRecording=e,this.userCallback=t,e&&(this.patches=[]),this.cachedProxy=this.proxifyObjectTree(this.originalObject),this.cachedProxy},r.prototype.generate=function(){if(!this.isRecording)throw new Error("You should set record to true to get patches later");return this.patches.splice(0,this.patches.length)},r.prototype.revoke=function(){this.proxifiedObjectsMap.forEach(e=>{e.revoke()})},r.prototype.disableTraps=function(){this.proxifiedObjectsMap.forEach(this.disableTrapsForProxy,this)},r}();e.exports=o,e.exports.default=o}]).default;